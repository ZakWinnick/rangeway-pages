<section class="newsroom" id="newsroom" style="padding: 60px 0; background: var(--bg-secondary);">
  <div class="container">
    <div class="section-header">
      <span class="section-badge">Latest Updates</span>
      <h2>Latest from Newsroom</h2>
      <p>Stay updated with our latest announcements and insights</p>
    </div>

    <div id="newsroom-content" style="max-width: 800px; margin: 0 auto;">
      <div style="text-align: center; padding: 2rem;">
        <div style="display: inline-block; width: 40px; height: 40px; border: 3px solid var(--sunset-coral); border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p style="color: var(--text-secondary); margin-top: 1rem;">Loading latest update...</p>
      </div>
    </div>

    <div style="text-align: center; margin-top: 2rem;">
      <a href="https://newsroom.rangeway.energy" target="_blank" rel="noopener noreferrer" class="btn-secondary">
        Visit Full Newsroom
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 0.5rem;">
          <line x1="5" y1="12" x2="19" y2="12"/>
          <polyline points="12 5 19 12 12 19"/>
        </svg>
      </a>
    </div>
  </div>
</section>

<script>
// Fetch latest newsroom item (single item, not array)
fetch('https://newsroom.rangeway.energy/latest.json')
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(data => {
    const container = document.getElementById('newsroom-content');

    // Build the image HTML if image exists
    const imageHtml = data.image ? `
      <div style="margin: -2.5rem -2.5rem 2rem -2.5rem; border-radius: 12px 12px 0 0; overflow: hidden;">
        <a href="${data.url}" target="_blank" rel="noopener noreferrer">
          <img src="${data.image}" alt="${data.title}" style="width: 100%; height: 300px; object-fit: cover; display: block; transition: transform 0.3s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
        </a>
      </div>
    ` : '';

    container.innerHTML = `
      <div class="card" style="padding: 2.5rem; transition: transform 0.3s ease, box-shadow 0.3s ease;">
        ${imageHtml}

        <div style="display: inline-block; background: rgba(240, 144, 96, 0.15); color: var(--sunset-coral); padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 1.5rem;">
          ${data.type || 'Update'}
        </div>

        <h3 style="font-size: 1.75rem; margin-bottom: 1rem; color: var(--text-heading);">
          <a href="${data.url}" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none; transition: color 0.3s ease;" onmouseover="this.style.color='var(--sunset-coral)'" onmouseout="this.style.color='var(--text-heading)'">${data.title}</a>
        </h3>

        <p style="color: var(--text-secondary); font-size: 0.95rem; margin-bottom: 1rem;">${data.dateFormatted || new Date(data.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

        <p style="color: var(--text-secondary); font-size: 1.05rem; line-height: 1.7; margin-bottom: 2rem;">${data.excerpt || ''}</p>

        <a href="${data.url}" target="_blank" rel="noopener noreferrer" style="color: var(--sunset-coral); text-decoration: none; font-weight: 600; font-size: 1rem; display: inline-flex; align-items: center; gap: 0.5rem; transition: color 0.3s ease;">
          Read full ${(data.type || 'article').toLowerCase()}
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="12" x2="19" y2="12"/>
            <polyline points="12 5 19 12 12 19"/>
          </svg>
        </a>
      </div>
    `;
  })
  .catch(error => {
    console.error('Error fetching newsroom:', error);
    const container = document.getElementById('newsroom-content');
    container.innerHTML = `
      <div class="card" style="text-align: center; padding: 2rem; background: rgba(255, 152, 0, 0.1); border: 1px solid rgba(255, 152, 0, 0.3);">
        <p style="color: var(--text-secondary); margin-bottom: 1rem;">Unable to load latest newsroom update.</p>
        <a href="https://newsroom.rangeway.energy" target="_blank" rel="noopener noreferrer" class="btn-primary">
          Visit Newsroom
        </a>
      </div>
    `;
  });
</script>
